
{
  "entities": {
    "User": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "User",
      "type": "object",
      "description": "Represents a user of the MotorLog application.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the User entity."
        },
        "email": {
          "type": "string",
          "description": "User's email address.",
          "format": "email"
        },
        "username": {
          "type": "string",
          "description": "User's username."
        }
      },
      "required": [
        "id",
        "email",
        "username"
      ]
    },
    "Vehicle": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Vehicle",
      "type": "object",
      "description": "Represents a vehicle managed within the MotorLog application.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Vehicle entity."
        },
        "make": {
          "type": "string",
          "description": "Vehicle's make (e.g., Toyota)."
        },
        "model": {
          "type": "string",
          "description": "Vehicle's model (e.g., Camry)."
        },
        "year": {
          "type": "number",
          "description": "Vehicle's manufacturing year."
        },
        "licensePlate": {
          "type": "string",
          "description": "Vehicle's license plate number."
        },
        "fuelCapacity": {
          "type": "number",
          "description": "Vehicle's fuel tank capacity in liters."
        }
      },
      "required": [
        "id",
        "make",
        "model",
        "year",
        "licensePlate",
        "fuelCapacity"
      ]
    },
    "FuelRecord": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "FuelRecord",
      "type": "object",
      "description": "Represents a fuel purchase record.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the FuelRecord entity."
        },
        "vehicleId": {
          "type": "string",
          "description": "Reference to the Vehicle this fuel record belongs to. (Relationship: Vehicle 1:N FuelRecord)"
        },
        "userId": {
          "type": "string",
          "description": "ID of the user who created the record."
        },
        "username": {
          "type": "string",
          "description": "Username of the user who created the record."
        },
        "date": {
          "type": "string",
          "description": "Date of the fuel purchase.",
          "format": "date-time"
        },
        "odometerReading": {
          "type": "number",
          "description": "Odometer reading at the time of the fuel purchase."
        },
        "fuelType": {
          "type": "string",
          "description": "Type of fuel purchased (e.g., Gasoline, Diesel)."
        },
        "pricePerLiter": {
          "type": "number",
          "description": "Price per liter of the fuel."
        },
        "totalCost": {
          "type": "number",
          "description": "Total cost of the fuel purchase."
        },
        "liters": {
          "type": "number",
          "description": "Number of liters of fuel purchased."
        },
        "gasStation": {
          "type": "string",
          "description": "Name of the gas station where the fuel was purchased."
        },
        "missedPreviousFillUp": {
          "type": "boolean",
          "description": "Indicates if the user forgot to log the previous fill-up, invalidating consumption calculation for this entry."
        }
      },
      "required": [
        "id",
        "vehicleId",
        "userId",
        "username",
        "date",
        "odometerReading",
        "fuelType",
        "pricePerLiter",
        "totalCost",
        "liters",
        "gasStation"
      ]
    },
    "ServiceReminder": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "ServiceReminder",
      "type": "object",
      "description": "Represents a service reminder for a vehicle.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the ServiceReminder entity."
        },
        "vehicleId": {
          "type": "string",
          "description": "Reference to the Vehicle this service reminder belongs to. (Relationship: Vehicle 1:N ServiceReminder)"
        },
        "serviceType": {
          "type": "string",
          "description": "Type of service to be performed (e.g., Oil Change, Tire Rotation)."
        },
        "dueDate": {
          "type": "string",
          "description": "Date when the service is due.",
          "format": "date-time"
        },
        "dueOdometer": {
          "type": "number",
          "description": "Odometer reading when the service is due."
        },
        "isCompleted": {
          "type": "boolean",
          "description": "Indicates whether the service has been completed."
        },
        "completedDate": {
            "type": "string",
            "format": "date-time",
            "description": "Date the service was completed."
        },
        "completedOdometer": {
            "type": "number",
            "description": "Odometer reading at the time of service completion."
        },
        "serviceLocation": {
            "type": "string",
            "description": "Location where the service was performed."
        },
        "cost": {
          "type": "number",
          "description": "Cost of the completed service."
        },
        "isRecurring": {
          "type": "boolean",
          "description": "Indicates if the service reminder is recurring."
        },
        "recurrenceIntervalKm": {
          "type": "number",
          "description": "The interval in kilometers for the recurrence."
        },
        "lastNotificationSent": {
          "type": "string",
          "format": "date-time",
          "description": "Timestamp of the last notification sent for this reminder."
        }
      },
      "required": [
        "id",
        "vehicleId",
        "serviceType",
        "isCompleted"
      ]
    },
    "Trip": {
      "title": "Trip",
      "description": "Represents a vehicle trip.",
      "type": "object",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier."
        },
        "vehicleId": {
          "type": "string",
          "description": "ID of the vehicle for this trip."
        },
        "userId": {
          "type": "string",
          "description": "ID of the user who started the trip."
        },
        "username": {
          "type": "string",
          "description": "Username of the user who started the trip."
        },
        "tripType": {
          "type": "string",
          "description": "The type of trip (e.g., Work, Vacation)."
        },
        "destination": {
          "type": "string",
          "description": "The destination of the trip."
        },
        "notes": {
          "type": "string",
          "description": "Optional notes about the trip."
        },
        "startDate": {
          "type": "string",
          "format": "date-time",
          "description": "Start date and time of the trip."
        },
        "startOdometer": {
          "type": "number",
          "description": "Odometer reading at the start of the trip."
        },
        "endDate": {
          "type": "string",
          "format": "date-time",
          "description": "End date and time of the trip."
        },
        "endOdometer": {
          "type": "number",
          "description": "Odometer reading at the end of the trip."
        },
        "status": {
          "type": "string",
          "enum": [
            "active",
            "completed"
          ],
          "description": "The current status of the trip."
        },
        "expenses": {
          "type": "array",
          "description": "A list of expenses associated with the trip.",
          "items": {
            "type": "object",
            "properties": {
              "description": {
                "type": "string"
              },
              "amount": {
                "type": "number"
              }
            },
            "required": ["description", "amount"]
          }
        }
      },
      "required": [
        "id",
        "vehicleId",
        "userId",
        "username",
        "tripType",
        "destination",
        "startDate",
        "startOdometer",
        "status"
      ]
    },
    "TripType": {
      "title": "TripType",
      "description": "Represents a configurable trip type.",
      "type": "object",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier."
        },
        "name": {
          "type": "string",
          "description": "Name of the trip type (e.g., 'Work')."
        }
      },
      "required": [
        "id",
        "name"
      ]
    },
    "FuelType": {
      "title": "FuelType",
      "description": "Represents a configurable fuel type.",
      "type": "object",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier."
        },
        "name": {
          "type": "string",
          "description": "Name of the fuel type (e.g., 'Gasolina Premium')."
        }
      },
      "required": [
        "id",
        "name"
      ]
    },
    "ServiceType": {
      "title": "ServiceType",
      "description": "Represents a configurable service type.",
      "type": "object",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier."
        },
        "name": {
          "type": "string",
          "description": "Name of the service (e.g., 'Rotación de neumáticos')."
        }
      },
      "required": [
        "id",
        "name"
      ]
    },
    "GasStation": {
      "title": "GasStation",
      "description": "Represents a configurable gas station.",
      "type": "object",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier."
        },
        "name": {
          "type": "string",
          "description": "Name of the gas station (e.g., 'Shell Av. Principal')."
        }
      },
      "required": [
        "id",
        "name"
      ]
    },
    "PushSubscription": {
      "title": "PushSubscription",
      "description": "Represents a user's push notification subscription.",
      "type": "object",
      "properties": {
        "userId": {
          "type": "string",
          "description": "The ID of the user this subscription belongs to."
        },
        "subscription": {
          "type": "object",
          "description": "The PushSubscription object from the browser."
        },
        "createdAt": {
          "type": "string",
          "format": "date-time",
          "description": "Timestamp of when the subscription was created."
        }
      }
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "User",
          "schema": {
            "$ref": "#/backend/entities/User"
          },
          "description": "Stores user profiles. User documents are created upon user registration. The `userId` parameter corresponds to the Firebase Auth UID."
        }
      },
      {
        "path": "/vehicles/{vehicleId}",
        "definition": {
          "entityName": "Vehicle",
          "schema": {
            "$ref": "#/backend/entities/Vehicle"
          },
          "description": "Stores all vehicles. Any authenticated user can access this data."
        }
      },
      {
        "path": "/vehicles/{vehicleId}/fuel_records/{fuelRecordId}",
        "definition": {
          "entityName": "FuelRecord",
          "schema": {
            "$ref": "#/backend/entities/FuelRecord"
          },
          "description": "Stores fuel records for a specific vehicle. Any authenticated user can access this data."
        }
      },
      {
        "path": "/vehicles/{vehicleId}/service_reminders/{serviceReminderId}",
        "definition": {
          "entityName": "ServiceReminder",
          "schema": {
            "$ref": "#/backend/entities/ServiceReminder"
          },
          "description": "Stores service reminders for a specific vehicle. Any authenticated user can access this data."
        }
      },
       {
        "path": "/vehicles/{vehicleId}/trips/{tripId}",
        "definition": {
          "entityName": "Trip",
          "schema": {
            "$ref": "#/backend/entities/Trip"
          },
          "description": "Stores trips for a specific vehicle."
        }
      },
      {
        "path": "/fuel_types/{fuelTypeId}",
        "definition": {
          "entityName": "FuelType",
          "schema": {
            "$ref": "#/backend/entities/FuelType"
          }
        }
      },
      {
        "path": "/service_types/{serviceTypeId}",
        "definition": {
          "entityName": "ServiceType",
          "schema": {
            "$ref": "#/backend/entities/ServiceType"
          }
        }
      },
      {
        "path": "/gas_stations/{gasStationId}",
        "definition": {
          "entityName": "GasStation",
          "schema": {
            "$ref": "#/backend/entities/GasStation"
          }
        }
      },
      {
        "path": "/trip_types/{tripTypeId}",
        "definition": {
          "entityName": "TripType",
          "schema": {
            "$ref": "#/backend/entities/TripType"
          }
        }
      },
      {
        "path": "/subscriptions/{subscriptionId}",
        "definition": {
          "entityName": "PushSubscription",
          "schema": {
            "$ref": "#/backend/entities/PushSubscription"
          },
          "description": "Stores user push notification subscriptions."
        }
      }
    ],
    "reasoning": "The Firestore structure is designed for collaboration. All data entities like vehicles, fuel records, and reminders are in top-level collections, accessible by any authenticated user. This removes the user-specific data nesting, allowing for a shared data model. User profiles are kept separate and private. A new top-level collection 'subscriptions' is added to store push notification subscriptions."
  }
}

    